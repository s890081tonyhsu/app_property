= render "lend/subnav"

- lendStatus = ["不予准許","正在借用","審核中","違規過期"]
- statusClass = ["btn-danger", "btn-success", "btn-warning", "btn-danger"]

.form-horizontal{:role => 'form'}
  = form_tag lend_path+'/audit' do
    %table.table.table-hover
      %tr
        %th 借閱人姓名
        %th 借閱物品
        %th 批准狀態
        %th 申請表單日期
      - @lendData.each do |anLend|
        %tr
          %td
            = anLend.LendName 
          %td
            - if Item.where(:id => anLend.ItemId).blank?
              = content_tag("該物品已被刪除")
            - else
              = link_to Item.find(anLend.ItemId).ItemName, item_path+"/"+@itemData.find(anLend.ItemId).id.to_s
          %td
            .text-center
              = link_to button_tag(lendStatus[anLend.ItemLendStatus], :class => ["btn", statusClass[anLend.ItemLendStatus]]), :action => "show_lend", :id => anLend.id
            .well.switch.switch-3
              = radio_button_tag 'audit' + '[' + anLend.id.to_s + ']', 'default', true 
              = label_tag 'audit[' + anLend.id.to_s + ']_default', '未決定', onclick: "", class: "col-ms-12"
              = radio_button_tag 'audit' + '[' + anLend.id.to_s + ']', 'pass'
              = label_tag 'audit[' + anLend.id.to_s + ']_pass', '通過', onclick: "", class: "col-ms-12"
              = radio_button_tag 'audit' + '[' + anLend.id.to_s + ']', 'reject'
              = label_tag 'audit[' + anLend.id.to_s + ']_reject', '回絕', onclick: "", class: "col-ms-12"
              %span.slide-button.btn.btn-info
          %td
            = anLend.created_at
    .form-group
      .col-sm-offset-2.col-sm-8
        = submit_tag 'Save', class: 'form-control'

.col-sm-12
  - if @error.blank?
    .alert.alert-success
      %a.close{:href => "#", :"data-dismiss" => "alert"} &times;
      = "審核已付諸執行"
  - else
    - @error.each do |text|
      .alert.alert-danger.alert-error
        %a.close{:href => "#", :"data-dismiss" => "alert"} &times;
        = text
